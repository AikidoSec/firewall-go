meta:
  name: path
  description: Protection from Local File Inclusion (LFI) Attacks.

rules:
  - id: path.Join
    type: prepend
    package: path
    function: Join
    imports:
      zentransits: github.com/AikidoSec/firewall-go/instrumentation/transits
    template: |
      if examinePath := zentransits.ExaminePath(); examinePath != nil {
        const _aikido_deferReporting = true
        examinePath("path.Join", {{ .Function.Argument 0 }}, _aikido_deferReporting)
      }
