# yaml-language-server: $schema=https://datadoghq.dev/orchestrion/schema.json
meta:
  name: github.com/AikidoSec/firewall-go/instrumentation/sinks/path/filepath
  description: |-
    Protection from Local File Inclusion (LFI) Attacks
aspects:
  - id: JoinPath
    join-point:
      all-of:
        - import-path: path/filepath
        - function-body:
            function:
              - name: Join
    advice:
      - prepend-statements:
          imports:
            zentransits: github.com/AikidoSec/firewall-go/internal/vulnerabilities/transits
          template: |-
            if examinePath := zentransits.ExaminePath(); examinePath != nil {
              const _aikido_deferReporting = true
              examinePath("filepath.Join", {{ .Function.Argument 0 }}, _aikido_deferReporting)
            }
