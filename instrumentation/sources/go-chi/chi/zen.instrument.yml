meta:
  name: go-chi/chi
  description: Chi is a lightweight, idiomatic and composable router for building Go HTTP services.

rules:
  - id: chi.NewMux
    type: wrap
    match: github.com/go-chi/chi/v5.NewMux
    exclude:
      - github.com/go-chi/chi/v5
      - github.com/go-chi/chi/v5/middleware
    imports:
      zenchi: github.com/AikidoSec/firewall-go/instrumentation/sources/go-chi/chi
    template: |
      func() *chi.Mux { r := {{.}}; r.Use(zenchi.GetMiddleware()); return r }()

  - id: chi.NewRouter
    type: wrap
    match: github.com/go-chi/chi/v5.NewRouter
    exclude:
      - github.com/go-chi/chi/v5
      - github.com/go-chi/chi/v5/middleware
    imports:
      zenchi: github.com/AikidoSec/firewall-go/instrumentation/sources/go-chi/chi
    template: |
      func() *chi.Mux { r := {{.}}; r.Use(zenchi.GetMiddleware()); return r }()
