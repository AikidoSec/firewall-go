meta:
  name: labstack/echo
  description: High performance, extensible, minimalist Go web framework.

rules:
  - id: echo.New
    type: wrap
    match: github.com/labstack/echo/v4.New
    imports:
      echo: github.com/labstack/echo/v4
      zenecho: github.com/AikidoSec/firewall-go/instrumentation/sources/labstack/echo
    template: |
      func() *echo.Echo { e := {{.}}; e.Use(zenecho.GetMiddleware()); return e }()

