package sql_injection

import (
	"github.com/AikidoSec/firewall-go/internal/vulnerabilities"
	"github.com/AikidoSec/firewall-go/internal/vulnerabilities/zen_internals"
)

var SQLInjectionVulnerability = vulnerabilities.Vulnerability{
	ScanFunction: scanFunction,
	Name:         "sql_injection",
	Error:        "A sql injection has been detected.",
}

func scanFunction(userInput string, args []string) bool {
	if len(args) != 2 {
		return false
	}

	var statement = args[0]
	var dialect = zen_internals.GetSqlDialectFromString(args[1])

	return detectSQLInjection(statement, userInput, dialect)
}
