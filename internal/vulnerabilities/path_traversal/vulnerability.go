package path_traversal

import "github.com/AikidoSec/firewall-go/internal/vulnerabilities"

var PathTraversalVulnerability = vulnerabilities.Vulnerability{
	ScanFunction: scanFunction,
	Name:         "path_traversal",
	Error:        "A path traversal attack has been detected.",
}

func scanFunction(userInput string, args []string) bool {
	if len(args) != 2 {
		return false
	}
	var filePath = args[0]
	var checkPathStart = args[1] == "1"

	return detectPathTraversal(filePath, userInput, checkPathStart)
}
